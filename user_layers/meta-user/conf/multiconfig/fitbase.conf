# Base fitImage generation configuration common for generating fitImage with ramdisk as both
# fitImage subimage and kernel initramfs.
#
# Image types produced by kernel class. We just need fitImage.
KERNEL_IMAGETYPE = "fitImage"
# Additional classes the kernel class will inherit.
KERNEL_CLASSES += "kernel-fitimage"
# Initramfs image used for fitImage and for inclusion
# in kernel, if requested. Settings this variable isn't
# enough to inline said image into kernel. One also needs
# to set variable INITRAMFS_IMAGE_BUNDLE to 1.
INITRAMFS_IMAGE = "uimg-min-initramfs"
# The kind of inclusion of ramdisk into fitImage doesn't affect medium image layout.
WKS_FILES = "uimg-min-fit.wks.in"
# Use unified name for uimg-min-fit and uimg-min-kfit. Otherwise I need image and kernel
# artifact names in u-boot and possible somewhere else in the future. Instead, the kernel
# will export the fitImage that I need for current build by this name.
USER_FITIMAGE_NAME = "fitImage-with-ramdisk"
# We don't need a dtb file on /boot since it's included in fitImage.
IMAGE_BOOT_FILES = "boot.scr ${USER_FITIMAGE_NAME}"
# Undo append made by sunxi.inc
IMAGE_BOOT_FILES:remove = "${KERNEL_DEVICETREE}"
# Should go after kernel. Check UBOOT_LOADADDRESS for kernel load address
# and add some space to make sure it's not overwritten.
# 16M is allocated in this case.
USER_FITIMAGE_LOADADDR = "0x41008000"
